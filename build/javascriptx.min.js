/*! javascriptx 2013-09-17 */
function Either(){}function Left(a){return new _Left(a)}function _Left(a){this.isLeft=!0,this.isRight=!1,this.a=a}function Right(a){return new _Right(a)}function _Right(a){this.isLeft=!1,this.isRight=!0,this.b=a}function LeftProjection(a){this.get=function(){if(a.isLeft)return a.a;throw"Either.left.value on Right"},this.foreach=function(b){return a.isLeft?b(a.a):void 0},this.getOrElse=function(b){return a.isLeft?a.a:b},this.forall=function(b){return a.isLeft?b(a.a):!0},this.exists=function(b){return a.isLeft?b(a.a):!1},this.flatMap=function(b){return a.isLeft?b(a.a):Right(a.b)},this.map=function(b){return a.isLeft?Left(b(a.a)):None},this.filter=function(b){return a.isLeft?b(a.a)?Some(Left(a.a)):None:None},this.toSeq=function(){return a.isLeft?[a.a]:[]},this.toOption=function(){return a.isLeft?Some(a.a):None}}function RightProjection(a){this.get=function(){if(a.isRight)return a.b;throw"Either.right.value on Left"},this.foreach=function(b){return a.isRight?b(a.b):void 0},this.getOrElse=function(b){return a.isRight?a.b:b},this.forall=function(b){return a.isRight?b(a.b):!0},this.exists=function(b){return a.isRight?b(a.b):!1},this.flatMap=function(b){return a.isRight?b(a.b):Right(a.a)},this.map=function(b){return a.isRight?Right(b(a.b)):None},this.filter=function(b){return a.isRight?b(a.b)?Some(Right(a.b)):None:None},this.toSeq=function(){return a.isRight?[a.b]:[]},this.toOption=function(){return a.isRight?Some(a.b):None}}function Option(){}function Some(a){return new _Some(a)}function _Some(a){this.isEmpty=!1,this.get=function(){return a}}function _None(){this.isEmpty=!0,this.get=function(){throw"NoSuchElementException(None.get)"}}Either.prototype.left=function(){return Either.LeftProjection(this)},Either.prototype.right=function(){return Either.RightProjection(this)},Either.prototype.fold=function(a,b){return this.isLeft?a(this.a):b(this.b)},Either.prototype.swap=function(){return this.isLeft?Right(this.a):Left(this.b)},Either.prototype.joinRight=function(){return this.isRight?Right(this.b):Left(Left(this.a))},Either.prototype.joinLeft=function(){return this.isLeft?Left(this.a):Right(Right(this.b))},Either.merge=function(a){return a.isLeft?a.a:a.b},Either.LeftProjection=function(a){return new LeftProjection(a)},Either.RightProjection=function(a){return new RightProjection(a)},_Left.prototype=new Either,_Right.prototype=new Either;var None;Option.prototype.equals=function(a){return this.isEmpty&&a.isEmpty||!this.isEmpty&&!a.isEmpty&&this.get()===a.get()},Option.prototype.isDefined=function(){return!this.isEmpty},Option.prototype.getOrElse=function(a){return this.isEmpty?a:this.get()},Option.prototype.orNull=function(){return this.isEmpty?null:this.get()},Option.prototype.orElse=function(a){return this.isEmpty?a:this},Option.prototype.exists=function(a){return!this.isEmpty&&a(this.get())},Option.prototype.forall=function(a){return this.isEmpty||a(this.get())},Option.prototype.map=function(a){return this.isEmpty?None:Some(a(this.get()))},Option.prototype.flatMap=function(a){return this.isEmpty?None:a(this.get())},Option.prototype.filter=function(a){return this.isEmpty||a(this.get())?this:None},Option.prototype.withFilter=function(a){function b(a){this.map=function(b){return c.filter(a).map(b)},this.flatMap=function(b){return c.filter(a).flatMap(b)},this.foreach=function(b){return c.filter(a).foreach(b)},this.withFilter=function(c){return new b(function(b){return a(b)&&c(b)})}}var c=this;return new b(a)},Option.prototype.fold=function(a,b){return this.isEmpty?a():b(this.get())},Option.prototype.match=function(a,b){return this.isEmpty?b():a(this.get())},Option.prototype.foreach=function(a){return this.isEmpty?void 0:a(this.get())},Option.prototype.collect=function(a){return!this.isEmpty&&a.isDefinedAt(this.get())?Some(a(this.get())):None},Option.prototype.iterator=function(){return this.isEmpty?[]:[this.get()]},Option.apply=function(a){return void 0===a||null===a?None:Some(a)},_Some.prototype=new Option,Some.apply=function(a){return void 0===a?None:new Some(a)},_None.prototype=new Option,None=new _None,Array.prototype.sum=function(){return 0===this.length?0:1===this.length?parseInt(this[0],10):this.reduce(function(a,b){return a+b})},Array.prototype.head=function(){if(0===this.length)throw"NoSuchElement";return this[0]},Array.prototype.headOption=function(){return Option.apply(this[0])},Array.prototype.last=function(){if(0===this.length)throw"NoSuchElement";return this[this.length-1]},Array.prototype.lastOption=function(){return Option.apply(this[this.length-1])},Array.prototype.get=function(a){return this[a]},Array.prototype.getOrElse=function(a,b){return void 0!==this[a]?this[a]:b},Array.prototype.zip=function(a){for(var b=[],c=this.length<a.length?this:a,d=0,e=c.length;e>d;++d)b[d]=[this[d],a[d]];return b},Array.prototype.zipAll=function(a,b,c){for(var d=[],e=this.length>a.length?this:a,f=0,g=e.length;g>f;++f){var h=void 0===this[f]?b:this[f],i=void 0===a[f]?c:a[f];d[f]=[h,i]}return d},Array.prototype.clone=function(){return Array.apply(null,this)},function(){Date.prototype.getMonthLength=function(){return this.getMonthLast().getDate()},Date.prototype.getPrevMonth=function(){return this.dateAdd("month",-1)},Date.prototype.getNextMonth=function(){return this.dateAdd("month",1)},Date.prototype.getMonthFirst=function(){var a=this.getDatePart();return a.setDate(1),a},Date.prototype.getMonthLast=function(){var a=this.getMonthFirst();return a.setMonth(a.getMonth()+1),a.setDate(0),a},Date.prototype.getDatePart=function(){var a=this.clone();return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a};var a=function(a){switch(a){case"year":case"y":return"year";case"month":case"m":return"month";case"day":case"date":case"d":return"day";case"week":return"week";case"hour":return"hour";case"minute":return"minute";case"second":return"second";case"millisecond":return"millisecond"}},b=function(b,c){switch(a(b)){case"year":return this.thenYear(c);case"month":return this.thenMonth(c);case"day":return this.thenDay(c);case"week":return this.thenWeek(c);case"hour":return this.thenHour(c);case"minute":return this.thenMinute(c);case"second":return this.thenSecond(c);case"millisecond":return this.thenMillisecond(c)}};Date.prototype.dateAdd=function(a,c){var d=this,e=this.clone();return b.call(function(){this.thenYear=function(){return d.dateAdd("month",12*c)},this.thenMonth=function(){var a=e.getDate();return e.setDate(1),e.setMonth(e.getMonth()+c+1),e.setDate(0),e.setDate(Math.min(a,e.getDate())),e},this.thenDay=function(){return e.setDate(e.getDate()+c),e},this.thenWeek=function(){return d.dateAdd("day",7*c)},this.thenHour=function(){return e.setHours(e.getHours()+c),e},this.thenMinute=function(){return e.setMinutes(e.getMinutes()+c),e},this.thenSecond=function(){return e.setSeconds(e.getSeconds()+c),e},this.thenMillisecond=function(){return e.setMilliseconds(e.getMilliseconds()+c),e}}(),a)},Date.prototype.dateDiff=function(a,c){var d=this;return b.call(function(){this.thenYear=function(){return c.getFullYear()-d.getFullYear()},this.thenMonth=function(){return 12*d.dateDiff("year",c)+c.getMonth()-d.getMonth()},this.thenDay=function(){var a=(new Date).getDatePart().getTime();return Math.floor((c.getTime()-a)/864e5)-Math.floor((d.getTime()-a)/864e5)},this.thenWeek=function(){return Math.floor(d.dateDiff("day",c)/7)},this.thenHour=function(){var a=(new Date).getDatePart().getTime();return Math.floor((c.getTime()-a)/36e5)-Math.floor((d.getTime()-a)/36e5)},this.thenMinute=function(){var a=(new Date).getDatePart().getTime();return Math.floor((c.getTime()-a)/6e4)-Math.floor((d.getTime()-a)/6e4)},this.thenSecond=function(){var a=(new Date).getDatePart().getTime();return Math.floor((c.getTime()-a)/1e3)-Math.floor((d.getTime()-a)/1e3)},this.thenMillisecond=function(){return c.getTime()-d.getTime()}}(),a)},Date.prototype.toFormatString=function(a){var b=new Array("Sun","Mon","Tue","Web","Tur","Fri","Sat"),c=this.getFullYear().toString(),d=c.slice(2),e=(this.getMonth()+1).toString(),f=1===e.length?"0"+e:e,g=this.getDate().toString(),h=1===g.length?"0"+g:g,i=b[this.getDay()],j=this.getHours().toString(),k=1===j.length?"0"+j:j,l=(this.getHours()%12).toString(),m=1===l.length?"0"+l:l,n=this.getMinutes().toString(),o=1===n.length?"0"+n:n,p=this.getSeconds().toString(),q=1===p.length?"0"+p:p,r="000"+this.getMilliseconds().toString(),s=r.substr(r.length-3,1),t=r.substr(r.length-3,2),u=r.substr(r.length-3,3);return"0"===l&&(l="12"),a.replace(/yyyy/g,c).replace(/yy/g,d).replace(/MM/g,f).replace(/M/g,e).replace(/ddd/g,i).replace(/dd/g,h).replace(/d/g,g).replace(/HH/g,k).replace(/H/g,j).replace(/hh/g,m).replace(/h/g,l).replace(/mm/g,o).replace(/m/g,n).replace(/ss/g,q).replace(/s/g,p).replace(/fff/g,u).replace(/ff/g,t).replace(/f/g,s)},Date.prototype.clone=function(){return new Date(this.getTime())}}(),Function.prototype.curried=function(){function a(c){return c.length>=b.length?b.apply(null,c):function(){return a(c.concat(Array.prototype.slice.call(arguments)))}}var b=this;return 0===b.length?this:a([])},Function.prototype.andThen=function(a){var b=this;return function(c){return a(b(c))}},Function.prototype.compose=function(a){var b=this;return function(c){return b(a(c))}},String.prototype.format=function(a){var b,c=this;if("object"==typeof a)b=function(b,c){return a[c]?a[c]:b};else{var d=arguments,e=d.length-1;c=c.replace(/(?!\{)*\{\{(\w+)\}\}/g,function(a){d[++e]=a.replace("{{","{").replace("}}","}");var b="{"+e+"}";return b}),b=function(a,b){return d[parseInt(b,10)]}}return c.replace(/(?!\{)*\{(\w+)\}/g,b)},String.prototype.toInt=function(){return parseInt(this,10)},String.prototype.toFloat=function(){return parseFloat(this)},String.prototype.toIntOrZero=function(){return isNaN(this)?0:this.toInt()},String.prototype.toFloatOrZero=function(){return isNaN(this)?0:this.toFloat()},function(){var a=65248;String.prototype.toHalfNumber=function(){return this.replace(/[０１２３４５６７８９]/g,function(b){return String.fromCharCode(b.charCodeAt(0)-a)}).replace(/\d+\．\d+/g,function(a){return a.replace("．",".")})},String.prototype.toHalfAlphabet=function(){return this.replace(/[Ａ-Ｚａ-ｚ]/g,function(b){return String.fromCharCode(b.charCodeAt(0)-a)})}}(),String.prototype.removeFullWidth=function(){return this.replace(/[^!-~]/g,"")};